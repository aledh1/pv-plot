version: '3.8'

services:
  # iiscore:
  #   build:
  #     context: ./iiscore/
  #   image: 327322993001.dkr.ecr.eu-west-1.amazonaws.com/iiscore:latest
  #   ports:
  #     - "80:80"
  #   networks:
  #     - external

  # oeaccountservice:
  #   build:
  #     context: ./oeaccountservice/
  #   image: 327322993001.dkr.ecr.eu-west-1.amazonaws.com/oeaccountservice:latest
  #   ports:
  #     - "9082:9082"
  #     - "9083:9083"
  #   networks:
  #     - internal

  # prospectservice:
  #   build:
  #     context: ./prospectservice/
  #   image: 327322993001.dkr.ecr.eu-west-1.amazonaws.com/prospectservice:latest
  #   ports:
  #     - "9092:9092"
  #   networks:
  #     - internal

  oeweb_api_test:
    image: aledpv/oeweb-api:latestTest
    container_name: oeweb_api_test
    hostname: oeweb_api_test
    dns:
      - "172.30.1.20"
    dns_search:
      - "pottsmullarkey.com"
    ports:
      - "9001:80"
    networks:
      - internal

  oeweb_rs_test:
    image: aledpv/oeweb-rs:latestTest
    container_name: oeweb_rs_test
    hostname: oeweb_rs_test
    dns:
       - "172.30.1.20"
    dns_search:
       - "pottsmullarkey.com"   
    ports:
      - "9084:9084"
      - "9085:9085" 
    networks:
      - internal
    volumes:
      - 'C:\temp\DreamReg:C:\config'
      - 'C:\users\aledh\.aws:C:\users\administrator\.aws'
    environment:
      - AWS_DEFAULT_REGION=eu-west-2
      - PLOT_CONFIG_SOURCE=s3://pv-plot-configuration/test
      - 'PLOT_CONFIG_TARGET=C:\Program Files (x86)\OE Accounts Remoting\OERemotingService.exe.config'

  plot_rs_test:
    image: aledpv/plot-rs:latestTest
    container_name: plot_rs_test
    hostname: plot_rs_test
    dns:
       - "172.30.1.20"
    dns_search:
       - "pottsmullarkey.com"    
    ports:
      - "8085:8085"
      - "8086:8086" 
      - "8087:8087"
    networks:
      - internal
    volumes:
      - 'C:\temp\DreamReg:C:\config'
      - 'C:\users\aledh\.aws:C:\users\containeradministrator\.aws'
    environment:
      - AWS_DEFAULT_REGION=eu-west-2
      - PLOT_CONFIG_SOURCE=s3://pv-plot-configuration/test
      - 'PLOT_CONFIG_TARGET=C:\Program Files (x86)\Plot Control Remoting Server\SiConRemotingService.exe.config'

  plot_rs_test_uploader:
    image: aledpv/plot-rs:latestTest
    container_name: plot_rs_test_uploader
    hostname: plot_rs_test_uploader
    dns:
       - "172.30.1.20"
    dns_search:
       - "pottsmullarkey.com"    
    ports:
      - "8185:8185"
      - "8186:8186" 
      - "8187:8187"
    networks:
      - internal
    volumes:
      - 'C:\temp\DreamReg:C:\config'
      - 'C:\users\aledh\.aws:C:\users\containeradministrator\.aws'
    environment:
      - AWS_DEFAULT_REGION=eu-west-2
      - PLOT_CONFIG_SOURCE=s3://pv-plot-configuration/test/uploader
      - 'PLOT_CONFIG_TARGET=C:\Program Files (x86)\Plot Control Remoting Server\SiConRemotingService.exe.config'

  plot_rs_test_scheduler:
    image: aledpv/plot-rs:latestTest
    container_name: plot_rs_test_scheduler
    hostname: plot_rs_test_scheduler
    dns:
       - "172.30.1.20"
    dns_search:
       - "pottsmullarkey.com"    
    ports:
      - "8285:8285"
      - "8286:8286" 
      - "8287:8287"
    networks:
      - internal
    volumes:
      - 'C:\temp\DreamReg:C:\config'
      - 'C:\users\aledh\.aws:C:\users\containeradministrator\.aws'
    environment:
      - AWS_DEFAULT_REGION=eu-west-2
      - PLOT_CONFIG_SOURCE=s3://pv-plot-configuration/test/scheduler
      - 'PLOT_CONFIG_TARGET=C:\Program Files (x86)\Plot Control Remoting Server\SiConRemotingService.exe.config'

networks:
  external:
    name: external
  internal:
    name: internal